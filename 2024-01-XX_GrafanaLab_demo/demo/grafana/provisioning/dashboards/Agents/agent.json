{
   "annotations": {
     "list": [
       {
         "builtIn": 1,
         "datasource": {
           "type": "grafana",
           "uid": "-- Grafana --"
         },
         "enable": true,
         "hide": true,
         "iconColor": "rgba(0, 211, 255, 1)",
         "name": "Annotations & Alerts",
         "type": "dashboard"
       }
     ]
   },
   "editable": true,
   "fiscalYearStartMonth": 0,
   "graphTooltip": 0,
   "links": [],
   "liveNow": false,
   "panels": [
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 0
       },
       "id": 7,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir"
           },
           "refId": "A"
         }
       ],
       "title": "Agent Stats",
       "type": "row"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "thresholds"
           },
           "custom": {
             "cellOptions": {
               "type": "auto"
             },
             "inspect": false
           },
           "decimals": 2,
           "displayName": "",
           "mappings": [],
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "short"
         },
         "overrides": [
           {
             "matcher": {
               "id": "byName",
               "options": "Time"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Time"
               },
               {
                 "id": "custom.align"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "Value #A"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Count"
               },
               {
                 "id": "unit",
                 "value": "short"
               },
               {
                 "id": "decimals",
                 "value": 2
               },
               {
                 "id": "custom.align"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "Value #B"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Uptime"
               },
               {
                 "id": "unit",
                 "value": "short"
               },
               {
                 "id": "decimals",
                 "value": 2
               },
               {
                 "id": "custom.align"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "container"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Container"
               },
               {
                 "id": "unit",
                 "value": "short"
               },
               {
                 "id": "decimals",
                 "value": 2
               },
               {
                 "id": "custom.align"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "pod"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Pod"
               },
               {
                 "id": "unit",
                 "value": "short"
               },
               {
                 "id": "decimals",
                 "value": 2
               },
               {
                 "id": "custom.align"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "version"
             },
             "properties": [
               {
                 "id": "displayName",
                 "value": "Version"
               },
               {
                 "id": "unit",
                 "value": "short"
               },
               {
                 "id": "decimals",
                 "value": 2
               },
               {
                 "id": "custom.align"
               }
             ]
           }
         ]
       },
       "gridPos": {
         "h": 7,
         "w": 24,
         "x": 0,
         "y": 1
       },
       "id": 1,
       "links": [],
       "options": {
         "cellHeight": "sm",
         "footer": {
           "countRows": false,
           "fields": "",
           "reducer": [
             "sum"
           ],
           "show": false
         },
         "showHeader": true
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "count by (pod, container, version) (agent_build_info{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"})",
           "format": "table",
           "instant": true,
           "intervalFactor": 2,
           "legendFormat": "",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "max by (pod, container) (time() - process_start_time_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"})",
           "format": "table",
           "instant": true,
           "intervalFactor": 2,
           "legendFormat": "",
           "refId": "B",
           "step": 10
         }
       ],
       "title": "Agent Stats",
       "transformations": [
         {
           "id": "merge",
           "options": {
             "reducers": []
           }
         }
       ],
       "type": "table"
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 8
       },
       "id": 8,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir"
           },
           "refId": "A"
         }
       ],
       "title": "Prometheus Discovery",
       "type": "row"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "palette-classic"
           },
           "custom": {
             "axisCenteredZero": false,
             "axisColorMode": "text",
             "axisLabel": "",
             "axisPlacement": "auto",
             "barAlignment": 0,
             "drawStyle": "line",
             "fillOpacity": 10,
             "gradientMode": "none",
             "hideFrom": {
               "legend": false,
               "tooltip": false,
               "viz": false
             },
             "insertNulls": false,
             "lineInterpolation": "linear",
             "lineWidth": 1,
             "pointSize": 5,
             "scaleDistribution": {
               "type": "linear"
             },
             "showPoints": "never",
             "spanNulls": false,
             "stacking": {
               "group": "A",
               "mode": "none"
             },
             "thresholdsStyle": {
               "mode": "off"
             }
           },
           "mappings": [],
           "min": 0,
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "ms"
         },
         "overrides": []
       },
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 9
       },
       "id": 2,
       "links": [],
       "options": {
         "legend": {
           "calcs": [],
           "displayMode": "list",
           "placement": "bottom",
           "showLegend": true
         },
         "tooltip": {
           "mode": "multi",
           "sort": "desc"
         }
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(prometheus_target_sync_length_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[5m])) by (pod, scrape_job) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{pod}}/{{scrape_job}}",
           "refId": "A",
           "step": 10
         }
       ],
       "title": "Target Sync",
       "type": "timeseries"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "palette-classic"
           },
           "custom": {
             "axisCenteredZero": false,
             "axisColorMode": "text",
             "axisLabel": "",
             "axisPlacement": "auto",
             "barAlignment": 0,
             "drawStyle": "line",
             "fillOpacity": 100,
             "gradientMode": "none",
             "hideFrom": {
               "legend": false,
               "tooltip": false,
               "viz": false
             },
             "insertNulls": false,
             "lineInterpolation": "linear",
             "lineWidth": 0,
             "pointSize": 5,
             "scaleDistribution": {
               "type": "linear"
             },
             "showPoints": "never",
             "spanNulls": false,
             "stacking": {
               "group": "A",
               "mode": "normal"
             },
             "thresholdsStyle": {
               "mode": "off"
             }
           },
           "mappings": [],
           "min": 0,
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "short"
         },
         "overrides": []
       },
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 9
       },
       "id": 3,
       "links": [],
       "options": {
         "legend": {
           "calcs": [],
           "displayMode": "list",
           "placement": "bottom",
           "showLegend": true
         },
         "tooltip": {
           "mode": "multi",
           "sort": "desc"
         }
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (pod) (prometheus_sd_discovered_targets{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"})",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{pod}}",
           "refId": "A",
           "step": 10
         }
       ],
       "title": "Targets",
       "type": "timeseries"
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 16
       },
       "id": 9,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir"
           },
           "refId": "A"
         }
       ],
       "title": "Prometheus Retrieval",
       "type": "row"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "palette-classic"
           },
           "custom": {
             "axisCenteredZero": false,
             "axisColorMode": "text",
             "axisLabel": "",
             "axisPlacement": "auto",
             "barAlignment": 0,
             "drawStyle": "line",
             "fillOpacity": 10,
             "gradientMode": "none",
             "hideFrom": {
               "legend": false,
               "tooltip": false,
               "viz": false
             },
             "insertNulls": false,
             "lineInterpolation": "linear",
             "lineWidth": 1,
             "pointSize": 5,
             "scaleDistribution": {
               "type": "linear"
             },
             "showPoints": "never",
             "spanNulls": false,
             "stacking": {
               "group": "A",
               "mode": "none"
             },
             "thresholdsStyle": {
               "mode": "off"
             }
           },
           "mappings": [],
           "min": 0,
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "ms"
         },
         "overrides": []
       },
       "gridPos": {
         "h": 7,
         "w": 8,
         "x": 0,
         "y": 17
       },
       "id": 4,
       "links": [],
       "options": {
         "legend": {
           "calcs": [],
           "displayMode": "list",
           "placement": "bottom",
           "showLegend": true
         },
         "tooltip": {
           "mode": "multi",
           "sort": "desc"
         }
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "rate(prometheus_target_interval_length_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[5m])\n/\nrate(prometheus_target_interval_length_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[5m])\n* 1e3\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{pod}} {{interval}} configured",
           "refId": "A",
           "step": 10
         }
       ],
       "title": "Average Scrape Interval Duration",
       "type": "timeseries"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "palette-classic"
           },
           "custom": {
             "axisCenteredZero": false,
             "axisColorMode": "text",
             "axisLabel": "",
             "axisPlacement": "auto",
             "barAlignment": 0,
             "drawStyle": "line",
             "fillOpacity": 100,
             "gradientMode": "none",
             "hideFrom": {
               "legend": false,
               "tooltip": false,
               "viz": false
             },
             "insertNulls": false,
             "lineInterpolation": "linear",
             "lineWidth": 0,
             "pointSize": 5,
             "scaleDistribution": {
               "type": "linear"
             },
             "showPoints": "never",
             "spanNulls": false,
             "stacking": {
               "group": "A",
               "mode": "normal"
             },
             "thresholdsStyle": {
               "mode": "off"
             }
           },
           "mappings": [],
           "min": 0,
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "short"
         },
         "overrides": []
       },
       "gridPos": {
         "h": 7,
         "w": 8,
         "x": 8,
         "y": 17
       },
       "id": 5,
       "links": [],
       "options": {
         "legend": {
           "calcs": [],
           "displayMode": "list",
           "placement": "bottom",
           "showLegend": true
         },
         "tooltip": {
           "mode": "multi",
           "sort": "desc"
         }
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (job) (rate(prometheus_target_scrapes_exceeded_sample_limit_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[1m]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "exceeded sample limit: {{job}}",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (job) (rate(prometheus_target_scrapes_sample_duplicate_timestamp_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[1m]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "duplicate timestamp: {{job}}",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (job) (rate(prometheus_target_scrapes_sample_out_of_bounds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[1m]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "out of bounds: {{job}}",
           "refId": "C",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (job) (rate(prometheus_target_scrapes_sample_out_of_order_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[1m]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "out of order: {{job}}",
           "refId": "D",
           "step": 10
         }
       ],
       "title": "Scrape failures",
       "type": "timeseries"
     },
     {
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "palette-classic"
           },
           "custom": {
             "axisCenteredZero": false,
             "axisColorMode": "text",
             "axisLabel": "",
             "axisPlacement": "auto",
             "barAlignment": 0,
             "drawStyle": "line",
             "fillOpacity": 100,
             "gradientMode": "none",
             "hideFrom": {
               "legend": false,
               "tooltip": false,
               "viz": false
             },
             "insertNulls": false,
             "lineInterpolation": "linear",
             "lineWidth": 0,
             "pointSize": 5,
             "scaleDistribution": {
               "type": "linear"
             },
             "showPoints": "never",
             "spanNulls": false,
             "stacking": {
               "group": "A",
               "mode": "normal"
             },
             "thresholdsStyle": {
               "mode": "off"
             }
           },
           "mappings": [],
           "min": 0,
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unit": "short"
         },
         "overrides": []
       },
       "gridPos": {
         "h": 7,
         "w": 8,
         "x": 16,
         "y": 17
       },
       "id": 6,
       "links": [],
       "options": {
         "legend": {
           "calcs": [],
           "displayMode": "list",
           "placement": "bottom",
           "showLegend": true
         },
         "tooltip": {
           "mode": "multi",
           "sort": "desc"
         }
       },
       "pluginVersion": "10.1.5",
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (job, instance_group_name) (rate(agent_wal_samples_appended_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"$container\"}[5m]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{job}} {{instance_group_name}}",
           "refId": "A",
           "step": 10
         }
       ],
       "title": "Appended Samples",
       "type": "timeseries"
     }
   ],
   "refresh": "30s",
   "schemaVersion": 38,
   "style": "dark",
   "tags": [
     "grafana-agent-mixin"
   ],
   "templating": {
     "list": [
       {
         "current": {
           "selected": false,
           "text": "default",
           "value": "default"
         },
         "hide": 0,
         "includeAll": false,
         "label": "Data Source",
         "multi": false,
         "name": "datasource",
         "options": [],
         "query": "prometheus",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "type": "datasource"
       },
       {
         "allValue": ".+",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "cluster",
         "multi": true,
         "name": "cluster",
         "options": [],
         "query": "label_values(agent_build_info, cluster)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       },
       {
         "allValue": ".+",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "namespace",
         "multi": true,
         "name": "namespace",
         "options": [],
         "query": "label_values(agent_build_info, namespace)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       },
       {
         "allValue": ".+",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "container",
         "multi": true,
         "name": "container",
         "options": [],
         "query": "label_values(agent_build_info, container)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       },
       {
         "allValue": "grafana-agent-.*",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "pod",
         "multi": true,
         "name": "pod",
         "options": [],
         "query": "label_values(agent_build_info{container=~\"$container\"}, pod)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       }
     ]
   },
   "time": {
     "from": "now-1h",
     "to": "now"
   },
   "timepicker": {
     "refresh_intervals": [
       "5s",
       "10s",
       "30s",
       "1m",
       "5m",
       "15m",
       "30m",
       "1h",
       "2h",
       "1d"
     ],
     "time_options": [
       "5m",
       "15m",
       "1h",
       "6h",
       "12h",
       "24h",
       "2d",
       "7d",
       "30d"
     ]
   },
   "timezone": "",
   "title": "Agent",
   "uid": "c6ffdb11-c8f4-4926-a7f8-5ce8e0c10e90",
   "version": 1,
   "weekStart": ""
 }